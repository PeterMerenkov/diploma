@startuml
start
:Создать новую книгу Excel и поток вывода;
:Создать новый лист Результаты в книге Excel;
:Создать первую строку и ячейки для заголовков;
repeat :Итерация по условиям в наборе данных результата;
  :Создать новую строку для текущего условия;
  :Заполнить ячейки строки данными условия;
repeat while (Есть еще условия в наборе данных результата)
:Создать пустые строки;
:Создать строку и ячейки для заголовков результатов;
repeat :Итерация по записям в карте времени и списках набора данных результата;
  :Создать новую строку для текущей записи;
  :Заполнить ячейки строки данными записи;
repeat while (Есть еще записи в карте времени и списках набора данных результата)
:Записать данные книги Excel в поток вывода;
:Создать результирующий файл из потока вывода;
:Вернуть результирующий файл;
stop
@enduml